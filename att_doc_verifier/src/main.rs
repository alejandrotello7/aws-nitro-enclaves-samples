
use std::collections::HashMap;
use std::fs::{File, read, read_to_string};
use std::io::Write;
use nitro_enclave_attestation_document::AttestationDocument;
use nsm_io::Response;
use serde::{Deserialize, Serialize};
use std::{fs, str};
use std::process::Command;
use serde_json::from_str;



#[derive(Serialize, Deserialize)]
struct AttestationDocumentDecoded {
    pcrs: HashMap<String, String>,
    nonce: String,
    module_id: String,
    public_key: String,
}
fn main() {
    let current_dir = std::env::current_dir().unwrap();
    let file_path = current_dir.join("cert.der");
    let binding = read(file_path).unwrap();
    let cert = binding.as_slice();

    let output = Command::new("curl")
        .arg("-X")
        .arg("GET")
        .arg("https://ec2-18-156-193-73.eu-central-1.compute.amazonaws.com:5000/api/attestation_retriever")
        .arg("--header")
        .arg("Content-Type: text/html")
        .arg("--data")
        .arg("@-")  //
        .arg("--silent")  // Suppress progress meter
        .arg("-o")
        .arg("/dev/stdout")  // Output to stdout
        .stdin(std::process::Stdio::piped())
        .output()
        .expect("Failed to execute curl");

    // let response = String::from_utf8_lossy(&output.stdout).to_string();
    // let response_bytes: &[u8] = response.as_bytes();

    let response_bytes: &[u8] = &output.stdout;
    println!("{:?}", std::str::from_utf8(response_bytes));



    let mut file = File::create("response.txt");
    file.expect("REASON").write_all(response_bytes);
    let byte_array = {[132, 68, 161, 1, 56, 34, 160, 89, 18, 187, 169, 105, 109, 111, 100, 117, 108, 101, 95, 105, 100, 120, 39, 105, 45, 48, 48, 49, 50, 54, 55, 98, 49, 97, 49, 53, 50, 48, 57, 100, 53, 102, 45, 101, 110, 99, 48, 49, 56, 57, 102, 57, 49, 54, 55, 101, 53, 51, 51, 54, 48, 55, 102, 100, 105, 103, 101, 115, 116, 102, 83, 72, 65, 51, 56, 52, 105, 116, 105, 109, 101, 115, 116, 97, 109, 112, 27, 0, 0, 1, 137, 249, 40, 250, 213, 100, 112, 99, 114, 115, 176, 0, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 88, 48, 198, 100, 4, 238, 254, 144, 202, 33, 236, 252, 115, 190, 41, 217, 124, 176, 210, 137, 39, 184, 39, 252, 214, 248, 152, 17, 35, 246, 151, 105, 51, 139, 50, 122, 27, 119, 201, 107, 13, 203, 183, 158, 222, 234, 52, 233, 31, 204, 4, 88, 48, 150, 39, 59, 181, 28, 75, 236, 49, 176, 126, 99, 90, 123, 110, 5, 149, 126, 37, 192, 150, 93, 93, 48, 145, 209, 218, 134, 25, 114, 237, 226, 201, 44, 128, 252, 230, 101, 111, 222, 148, 236, 184, 61, 87, 197, 123, 107, 98, 5, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 107, 99, 101, 114, 116, 105, 102, 105, 99, 97, 116, 101, 89, 2, 134, 48, 130, 2, 130, 48, 130, 2, 7, 160, 3, 2, 1, 2, 2, 16, 1, 137, 249, 22, 126, 83, 54, 7, 0, 0, 0, 0, 100, 219, 106, 63, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 129, 145, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 60, 48, 58, 6, 3, 85, 4, 3, 12, 51, 105, 45, 48, 48, 49, 50, 54, 55, 98, 49, 97, 49, 53, 50, 48, 57, 100, 53, 102, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 51, 48, 56, 49, 53, 49, 50, 48, 54, 50, 48, 90, 23, 13, 50, 51, 48, 56, 49, 53, 49, 53, 48, 54, 50, 51, 90, 48, 129, 150, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 65, 48, 63, 6, 3, 85, 4, 3, 12, 56, 105, 45, 48, 48, 49, 50, 54, 55, 98, 49, 97, 49, 53, 50, 48, 57, 100, 53, 102, 45, 101, 110, 99, 48, 49, 56, 57, 102, 57, 49, 54, 55, 101, 53, 51, 51, 54, 48, 55, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 211, 88, 16, 34, 251, 57, 237, 164, 213, 247, 17, 131, 47, 216, 153, 165, 93, 249, 139, 180, 228, 217, 45, 30, 215, 188, 181, 219, 189, 171, 19, 188, 68, 166, 154, 109, 27, 10, 90, 217, 176, 50, 236, 133, 56, 206, 242, 147, 148, 114, 214, 69, 255, 241, 206, 57, 182, 117, 21, 80, 21, 70, 43, 180, 19, 193, 241, 80, 138, 166, 71, 31, 219, 13, 82, 0, 101, 162, 27, 233, 13, 131, 28, 158, 135, 143, 226, 149, 96, 9, 127, 176, 57, 195, 53, 202, 163, 29, 48, 27, 48, 12, 6, 3, 85, 29, 19, 1, 1, 255, 4, 2, 48, 0, 48, 11, 6, 3, 85, 29, 15, 4, 4, 3, 2, 6, 192, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 177, 162, 226, 99, 38, 94, 6, 129, 232, 141, 139, 229, 23, 225, 25, 243, 28, 0, 10, 97, 101, 221, 146, 176, 114, 198, 81, 231, 55, 185, 142, 19, 93, 186, 41, 191, 85, 91, 178, 209, 111, 218, 161, 194, 191, 90, 193, 48, 2, 49, 0, 229, 114, 79, 51, 40, 201, 188, 148, 201, 225, 147, 184, 104, 218, 152, 207, 195, 135, 62, 249, 130, 228, 19, 96, 11, 16, 137, 226, 255, 80, 74, 252, 25, 68, 186, 48, 76, 45, 223, 105, 190, 151, 14, 75, 145, 170, 6, 16, 104, 99, 97, 98, 117, 110, 100, 108, 101, 132, 89, 2, 21, 48, 130, 2, 17, 48, 130, 1, 150, 160, 3, 2, 1, 2, 2, 17, 0, 249, 49, 117, 104, 27, 144, 175, 225, 29, 70, 204, 180, 228, 231, 248, 86, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 49, 57, 49, 48, 50, 56, 49, 51, 50, 56, 48, 53, 90, 23, 13, 52, 57, 49, 48, 50, 56, 49, 52, 50, 56, 48, 53, 90, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 252, 2, 84, 235, 166, 8, 193, 243, 104, 112, 226, 154, 218, 144, 190, 70, 56, 50, 146, 115, 110, 137, 75, 255, 246, 114, 217, 137, 68, 75, 80, 81, 229, 52, 164, 177, 246, 219, 227, 192, 188, 88, 26, 50, 183, 177, 118, 7, 14, 222, 18, 214, 154, 63, 234, 33, 27, 102, 231, 82, 207, 125, 209, 221, 9, 95, 111, 19, 112, 244, 23, 8, 67, 217, 220, 16, 1, 33, 228, 207, 99, 1, 40, 9, 102, 68, 135, 201, 121, 98, 132, 48, 77, 197, 63, 244, 163, 66, 48, 64, 48, 15, 6, 3, 85, 29, 19, 1, 1, 255, 4, 5, 48, 3, 1, 1, 255, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 144, 37, 181, 13, 217, 5, 71, 231, 150, 195, 150, 250, 114, 157, 207, 153, 169, 223, 75, 150, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 163, 127, 47, 145, 161, 201, 189, 94, 231, 184, 98, 124, 22, 152, 210, 85, 3, 142, 31, 3, 67, 249, 91, 99, 169, 98, 140, 61, 57, 128, 149, 69, 161, 30, 188, 191, 46, 59, 85, 216, 174, 238, 113, 180, 195, 214, 173, 243, 2, 49, 0, 162, 243, 155, 22, 5, 178, 112, 40, 165, 221, 75, 160, 105, 181, 1, 110, 101, 180, 251, 222, 143, 224, 6, 29, 106, 83, 25, 127, 156, 218, 245, 217, 67, 188, 97, 252, 43, 235, 3, 203, 111, 238, 141, 35, 2, 243, 223, 246, 89, 2, 197, 48, 130, 2, 193, 48, 130, 2, 72, 160, 3, 2, 1, 2, 2, 17, 0, 172, 236, 57, 104, 36, 94, 12, 212, 200, 202, 103, 62, 41, 58, 135, 90, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 51, 48, 56, 49, 51, 48, 53, 49, 50, 51, 51, 90, 23, 13, 50, 51, 48, 57, 48, 50, 48, 54, 49, 50, 51, 51, 90, 48, 103, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 57, 48, 55, 6, 3, 85, 4, 3, 12, 48, 55, 101, 52, 52, 97, 48, 100, 102, 99, 56, 54, 50, 98, 55, 97, 55, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 40, 81, 9, 55, 220, 182, 221, 121, 61, 122, 117, 97, 248, 200, 190, 66, 120, 85, 211, 79, 244, 175, 184, 81, 47, 146, 250, 255, 173, 211, 211, 205, 175, 254, 71, 11, 219, 222, 101, 6, 212, 147, 186, 122, 48, 136, 214, 165, 47, 27, 176, 73, 214, 170, 194, 198, 254, 163, 21, 180, 230, 248, 172, 149, 148, 244, 241, 117, 6, 159, 57, 227, 192, 4, 61, 158, 151, 104, 206, 99, 51, 149, 225, 253, 235, 169, 19, 118, 247, 208, 63, 236, 20, 244, 211, 195, 163, 129, 213, 48, 129, 210, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 2, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 144, 37, 181, 13, 217, 5, 71, 231, 150, 195, 150, 250, 114, 157, 207, 153, 169, 223, 75, 150, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 56, 234, 62, 26, 54, 120, 149, 178, 97, 106, 105, 104, 188, 18, 244, 154, 51, 3, 185, 160, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 108, 6, 3, 85, 29, 31, 4, 101, 48, 99, 48, 97, 160, 95, 160, 93, 134, 91, 104, 116, 116, 112, 58, 47, 47, 97, 119, 115, 45, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 45, 99, 114, 108, 46, 115, 51, 46, 97, 109, 97, 122, 111, 110, 97, 119, 115, 46, 99, 111, 109, 47, 99, 114, 108, 47, 97, 98, 52, 57, 54, 48, 99, 99, 45, 55, 100, 54, 51, 45, 52, 50, 98, 100, 45, 57, 101, 57, 102, 45, 53, 57, 51, 51, 56, 99, 98, 54, 55, 102, 56, 52, 46, 99, 114, 108, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 103, 0, 48, 100, 2, 48, 115, 253, 251, 58, 29, 171, 122, 76, 160, 59, 36, 85, 252, 19, 35, 101, 127, 170, 243, 222, 35, 206, 95, 14, 253, 238, 90, 120, 178, 11, 191, 136, 238, 6, 71, 7, 51, 101, 217, 141, 18, 145, 173, 164, 251, 45, 5, 17, 2, 48, 90, 48, 215, 179, 215, 18, 193, 60, 150, 246, 44, 57, 4, 24, 36, 46, 161, 39, 239, 231, 143, 140, 124, 212, 45, 148, 133, 162, 252, 82, 238, 210, 144, 101, 81, 107, 207, 18, 194, 223, 114, 255, 154, 53, 68, 165, 231, 183, 89, 3, 37, 48, 130, 3, 33, 48, 130, 2, 167, 160, 3, 2, 1, 2, 2, 17, 0, 244, 66, 75, 101, 178, 131, 91, 99, 34, 119, 191, 237, 218, 33, 182, 114, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 103, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 57, 48, 55, 6, 3, 85, 4, 3, 12, 48, 55, 101, 52, 52, 97, 48, 100, 102, 99, 56, 54, 50, 98, 55, 97, 55, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 51, 48, 56, 49, 53, 49, 48, 50, 50, 52, 56, 90, 23, 13, 50, 51, 48, 56, 50, 49, 48, 55, 50, 50, 52, 55, 90, 48, 129, 140, 49, 63, 48, 61, 6, 3, 85, 4, 3, 12, 54, 99, 97, 101, 54, 97, 51, 102, 100, 48, 48, 102, 49, 101, 101, 97, 48, 46, 122, 111, 110, 97, 108, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 11, 48, 9, 6, 3, 85, 4, 8, 12, 2, 87, 65, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 60, 46, 166, 179, 56, 23, 44, 50, 38, 111, 179, 34, 16, 139, 207, 200, 170, 212, 69, 133, 25, 145, 205, 253, 80, 73, 148, 1, 15, 176, 7, 220, 102, 69, 22, 74, 71, 128, 171, 238, 245, 192, 242, 254, 157, 253, 79, 212, 78, 126, 199, 72, 65, 205, 44, 192, 130, 139, 135, 157, 94, 232, 222, 19, 84, 8, 99, 89, 203, 254, 249, 136, 152, 179, 209, 233, 125, 249, 50, 143, 109, 41, 167, 162, 61, 15, 71, 236, 115, 245, 136, 56, 145, 86, 81, 94, 163, 129, 240, 48, 129, 237, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 1, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 56, 234, 62, 26, 54, 120, 149, 178, 97, 106, 105, 104, 188, 18, 244, 154, 51, 3, 185, 160, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 252, 186, 119, 152, 86, 103, 231, 232, 69, 110, 154, 192, 200, 82, 34, 4, 114, 144, 120, 169, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 129, 134, 6, 3, 85, 29, 31, 4, 127, 48, 125, 48, 123, 160, 121, 160, 119, 134, 117, 104, 116, 116, 112, 58, 47, 47, 99, 114, 108, 45, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 45, 97, 119, 115, 45, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 46, 115, 51, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 109, 97, 122, 111, 110, 97, 119, 115, 46, 99, 111, 109, 47, 99, 114, 108, 47, 53, 49, 97, 102, 98, 55, 49, 97, 45, 100, 99, 99, 99, 45, 52, 50, 48, 56, 45, 98, 50, 55, 101, 45, 101, 48, 56, 50, 57, 50, 52, 49, 57, 49, 55, 98, 46, 99, 114, 108, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 104, 0, 48, 101, 2, 49, 0, 141, 194, 182, 0, 139, 140, 243, 113, 162, 218, 18, 208, 152, 1, 22, 189, 34, 122, 187, 105, 224, 244, 66, 188, 185, 151, 27, 251, 199, 201, 169, 33, 164, 119, 166, 103, 88, 233, 255, 165, 35, 208, 38, 182, 146, 26, 48, 66, 2, 48, 10, 133, 172, 19, 73, 98, 80, 161, 110, 136, 131, 56, 31, 94, 240, 0, 175, 33, 106, 171, 128, 207, 198, 151, 55, 179, 57, 128, 221, 17, 1, 191, 19, 194, 136, 185, 131, 15, 245, 250, 62, 85, 81, 106, 167, 82, 231, 173, 89, 2, 137, 48, 130, 2, 133, 48, 130, 2, 11, 160, 3, 2, 1, 2, 2, 21, 0, 149, 22, 245, 223, 164, 194, 57, 58, 209, 95, 62, 245, 194, 37, 197, 37, 88, 34, 234, 216, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 129, 140, 49, 63, 48, 61, 6, 3, 85, 4, 3, 12, 54, 99, 97, 101, 54, 97, 51, 102, 100, 48, 48, 102, 49, 101, 101, 97, 48, 46, 122, 111, 110, 97, 108, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 11, 48, 9, 6, 3, 85, 4, 8, 12, 2, 87, 65, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 48, 30, 23, 13, 50, 51, 48, 56, 49, 53, 49, 50, 48, 50, 52, 48, 90, 23, 13, 50, 51, 48, 56, 49, 54, 49, 50, 48, 50, 52, 48, 90, 48, 129, 145, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 60, 48, 58, 6, 3, 85, 4, 3, 12, 51, 105, 45, 48, 48, 49, 50, 54, 55, 98, 49, 97, 49, 53, 50, 48, 57, 100, 53, 102, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 81, 19, 37, 179, 250, 229, 254, 84, 221, 27, 120, 134, 243, 143, 83, 84, 50, 197, 47, 251, 187, 162, 165, 50, 31, 58, 236, 135, 9, 253, 31, 238, 181, 112, 69, 238, 96, 160, 135, 143, 13, 88, 52, 204, 77, 63, 114, 199, 40, 23, 126, 28, 92, 77, 183, 30, 121, 101, 193, 163, 1, 166, 253, 93, 78, 110, 48, 107, 102, 221, 115, 181, 29, 154, 56, 230, 61, 10, 143, 68, 0, 151, 215, 7, 209, 184, 49, 220, 237, 125, 241, 98, 41, 118, 201, 201, 163, 38, 48, 36, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 0, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 2, 4, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 104, 0, 48, 101, 2, 48, 92, 15, 206, 245, 69, 221, 92, 248, 85, 231, 129, 116, 18, 233, 142, 30, 224, 86, 223, 34, 150, 198, 32, 48, 91, 17, 132, 191, 247, 46, 119, 69, 115, 118, 26, 190, 121, 109, 180, 27, 177, 216, 221, 72, 36, 156, 1, 59, 2, 49, 0, 169, 137, 220, 245, 158, 28, 126, 81, 243, 36, 236, 102, 109, 147, 244, 152, 255, 108, 173, 54, 162, 8, 157, 202, 211, 156, 200, 54, 166, 161, 189, 172, 89, 111, 212, 130, 70, 16, 114, 92, 180, 182, 98, 198, 132, 153, 4, 59, 106, 112, 117, 98, 108, 105, 99, 95, 107, 101, 121, 89, 1, 195, 45, 45, 45, 45, 45, 66, 69, 71, 73, 78, 32, 80, 85, 66, 76, 73, 67, 32, 75, 69, 89, 45, 45, 45, 45, 45, 10, 77, 73, 73, 66, 73, 106, 65, 78, 66, 103, 107, 113, 104, 107, 105, 71, 57, 119, 48, 66, 65, 81, 69, 70, 65, 65, 79, 67, 65, 81, 56, 65, 77, 73, 73, 66, 67, 103, 75, 67, 65, 81, 69, 65, 55, 114, 81, 49, 70, 108, 55, 113, 104, 106, 74, 75, 47, 65, 83, 48, 106, 47, 47, 110, 10, 70, 105, 67, 70, 111, 81, 115, 119, 90, 70, 107, 85, 120, 110, 99, 109, 50, 70, 43, 122, 105, 110, 101, 119, 54, 43, 117, 112, 75, 76, 43, 89, 86, 56, 56, 116, 112, 83, 49, 78, 43, 113, 118, 67, 78, 81, 85, 97, 69, 70, 53, 51, 52, 70, 83, 114, 113, 81, 82, 48, 79, 55, 102, 81, 10, 84, 54, 78, 66, 79, 97, 76, 70, 98, 78, 51, 67, 109, 88, 104, 78, 108, 43, 120, 89, 108, 80, 119, 49, 109, 75, 54, 104, 51, 115, 104, 120, 65, 47, 66, 110, 120, 86, 106, 100, 85, 103, 52, 99, 105, 89, 82, 49, 118, 76, 76, 115, 102, 108, 52, 102, 116, 86, 101, 74, 85, 52, 109, 50, 10, 72, 72, 43, 52, 67, 108, 115, 76, 103, 80, 87, 68, 49, 65, 83, 74, 43, 77, 114, 109, 52, 66, 73, 98, 109, 57, 112, 108, 75, 88, 66, 57, 89, 84, 70, 71, 57, 89, 106, 120, 51, 66, 47, 88, 85, 66, 74, 109, 55, 75, 73, 98, 98, 47, 85, 72, 48, 56, 115, 89, 56, 103, 52, 109, 10, 52, 57, 55, 82, 121, 108, 119, 86, 105, 98, 97, 83, 65, 75, 53, 43, 76, 84, 73, 79, 109, 84, 106, 98, 71, 75, 43, 55, 88, 80, 107, 97, 106, 55, 114, 102, 55, 105, 104, 102, 81, 97, 114, 84, 99, 48, 104, 89, 112, 120, 87, 121, 56, 105, 97, 75, 115, 117, 87, 114, 105, 84, 70, 82, 10, 76, 112, 110, 87, 103, 98, 116, 50, 88, 86, 51, 114, 78, 81, 79, 65, 108, 99, 65, 99, 54, 53, 56, 90, 80, 65, 81, 54, 74, 80, 98, 99, 43, 89, 105, 49, 89, 82, 103, 108, 104, 71, 107, 87, 79, 106, 73, 108, 115, 43, 56, 117, 117, 102, 101, 113, 97, 73, 81, 114, 81, 98, 103, 113, 10, 107, 81, 73, 68, 65, 81, 65, 66, 10, 45, 45, 45, 45, 45, 69, 78, 68, 32, 80, 85, 66, 76, 73, 67, 32, 75, 69, 89, 45, 45, 45, 45, 45, 10, 105, 117, 115, 101, 114, 95, 100, 97, 116, 97, 77, 104, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100, 33, 101, 110, 111, 110, 99, 101, 77, 78, 111, 110, 99, 101, 32, 105, 115, 32, 104, 101, 114, 101, 88, 96, 69, 24, 152, 168, 230, 227, 253, 196, 107, 90, 72, 144, 100, 221, 207, 232, 104, 74, 41, 140, 67, 227, 205, 209, 187, 167, 133, 250, 230, 224, 75, 175, 177, 24, 33, 30, 78, 91, 179, 245, 198, 252, 147, 63, 64, 225, 244, 101, 250, 195, 72, 247, 244, 247, 157, 115, 236, 209, 20, 158, 231, 245, 58, 2, 152, 1, 44, 44, 240, 19, 208, 4, 59, 210, 100, 7, 179, 54, 246, 219, 90, 217, 74, 57, 128, 38, 0, 74, 55, 168, 209, 112, 236, 147, 161, 59]};
    let u8_slice: &[u8] = &byte_array;

    let path = "response.txt";
    let file_content = match read_to_string(path) {
        Ok(content) => content,
        Err(err) => {
            eprintln!("Error reading file: {}", err);
            return;
        }
    };


    let _document = match AttestationDocument::authenticate(response_bytes, cert){
        Ok(_doc) => {
            println!("Correct");
        },
        Err(err) => {
            println!("Error: {}", err);
        }
    };

    // if let Ok(Response::Attestation { ref document }) = attestation_response {
    //     let document_attested = match AttestationDocument::authenticate(document.as_slice(), cert) {
    //         Ok(doc) => doc,
    //         Err(err) => {
    //             println!("{:?}", err);
    //             panic!("error invalid attestation document");
    //         }
    //     };
    //     println!("Correct!");
    //     let mut document_attested_decoded = AttestationDocumentDecoded {
    //         pcrs: HashMap::new(),
    //         nonce: String::new(),
    //         module_id: String::new(),
    //         public_key: String::new(),
    //     };
    //     // println!("-----");
    //     for (index, pcr) in document_attested.pcrs.iter().enumerate() {
    //         let hex_vector = decimal_to_hex(&pcr);
    //         let result = remove_brackets_commas_and_spaces(&hex_vector);
    //         // println!("PCR{} value is: {:?}",index, result);
    //         // println!("-----");
    //         let pcr_index = format!("PCR{}", index);
    //         document_attested_decoded.pcrs.insert(pcr_index, result);
    //     }
    //     // println!("Module Id: {:?}",document_attested.module_id);
    //
    //     document_attested_decoded.nonce = convert_decimals_to_ascii(document_attested.nonce);
    //     document_attested_decoded.module_id = document_attested.module_id;
    //     document_attested_decoded.public_key =
    //         option_vec_u8_to_string(document_attested.public_key);
    //
    //     // println!("{}",document_attested_decoded);
    //
    //     let json = serde_json::to_string(&document_attested_decoded).unwrap();
    //     println!("{}", json);
    // }
    // else if let Err(err) = attestation_response {
    //     println!("Error parsing response: {:?}", err);
    //     println!("Failed");
    // }






}
