use std::collections::HashMap;
use std::fs::{File, read};
use std::io::Write;
use nitro_enclave_attestation_document::AttestationDocument;
use nsm_io::Response;
use serde::{Deserialize, Serialize};
use std::str;
use std::process::Command;
use serde_json::from_str;



#[derive(Serialize, Deserialize)]
struct AttestationDocumentDecoded {
    pcrs: HashMap<String, String>,
    nonce: String,
    module_id: String,
    public_key: String,
}
fn main() {
    let current_dir = std::env::current_dir().unwrap();
    let file_path = current_dir.join("cert.der");
    let binding = read(file_path).unwrap();
    let cert = binding.as_slice();

    let output = Command::new("curl")
        .arg("-X")
        .arg("GET")
        .arg("https://ec2-3-127-237-34.eu-central-1.compute.amazonaws.com:5000/api/attestation_retriever")
        .arg("--header")
        .arg("Content-Type: text/html")
        .arg("--data")
        .arg("@-")  //
        .arg("--silent")  // Suppress progress meter
        .arg("-o")
        .arg("/dev/stdout")  // Output to stdout
        .stdin(std::process::Stdio::piped())
        .output()
        .expect("Failed to execute curl");



    let response = String::from_utf8_lossy(&output.stdout).to_string();
    let response_bytes: &[u8] = response.as_bytes();
    let mut file = File::create("response.txt");
    file.expect("REASON").write_all(response_bytes);

     let byte_array ={[132, 68, 161, 1, 56, 34, 160, 89, 18, 184, 169, 105, 109, 111, 100, 117, 108, 101, 95, 105, 100, 120, 39, 105, 45, 48, 48, 49, 50, 54, 55, 98, 49, 97, 49, 53, 50, 48, 57, 100, 53, 102, 45, 101, 110, 99, 48, 49, 56, 57, 102, 51, 99, 97, 48, 54, 56, 53, 48, 56, 99, 56, 102, 100, 105, 103, 101, 115, 116, 102, 83, 72, 65, 51, 56, 52, 105, 116, 105, 109, 101, 115, 116, 97, 109, 112, 27, 0, 0, 1, 137, 243, 211, 111, 162, 100, 112, 99, 114, 115, 176, 0, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 88, 48, 198, 100, 4, 238, 254, 144, 202, 33, 236, 252, 115, 190, 41, 217, 124, 176, 210, 137, 39, 184, 39, 252, 214, 248, 152, 17, 35, 246, 151, 105, 51, 139, 50, 122, 27, 119, 201, 107, 13, 203, 183, 158, 222, 234, 52, 233, 31, 204, 4, 88, 48, 150, 39, 59, 181, 28, 75, 236, 49, 176, 126, 99, 90, 123, 110, 5, 149, 126, 37, 192, 150, 93, 93, 48, 145, 209, 218, 134, 25, 114, 237, 226, 201, 44, 128, 252, 230, 101, 111, 222, 148, 236, 184, 61, 87, 197, 123, 107, 98, 5, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 107, 99, 101, 114, 116, 105, 102, 105, 99, 97, 116, 101, 89, 2, 133, 48, 130, 2, 129, 48, 130, 2, 7, 160, 3, 2, 1, 2, 2, 16, 1, 137, 243, 202, 6, 133, 8, 200, 0, 0, 0, 0, 100, 218, 15, 13, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 129, 145, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 60, 48, 58, 6, 3, 85, 4, 3, 12, 51, 105, 45, 48, 48, 49, 50, 54, 55, 98, 49, 97, 49, 53, 50, 48, 57, 100, 53, 102, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 51, 48, 56, 49, 52, 49, 49, 50, 52, 53, 56, 90, 23, 13, 50, 51, 48, 56, 49, 52, 49, 52, 50, 53, 48, 49, 90, 48, 129, 150, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 65, 48, 63, 6, 3, 85, 4, 3, 12, 56, 105, 45, 48, 48, 49, 50, 54, 55, 98, 49, 97, 49, 53, 50, 48, 57, 100, 53, 102, 45, 101, 110, 99, 48, 49, 56, 57, 102, 51, 99, 97, 48, 54, 56, 53, 48, 56, 99, 56, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 208, 202, 86, 254, 212, 81, 244, 158, 34, 139, 160, 129, 150, 140, 64, 120, 29, 188, 170, 146, 20, 161, 111, 22, 131, 234, 37, 182, 11, 217, 111, 107, 197, 171, 97, 150, 154, 189, 160, 227, 226, 58, 116, 38, 225, 64, 31, 81, 26, 50, 43, 244, 169, 119, 202, 104, 112, 173, 223, 250, 142, 108, 188, 170, 222, 6, 254, 76, 216, 144, 199, 66, 23, 95, 234, 45, 1, 136, 121, 194, 187, 204, 120, 106, 104, 56, 215, 29, 43, 171, 142, 190, 74, 246, 61, 102, 163, 29, 48, 27, 48, 12, 6, 3, 85, 29, 19, 1, 1, 255, 4, 2, 48, 0, 48, 11, 6, 3, 85, 29, 15, 4, 4, 3, 2, 6, 192, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 104, 0, 48, 101, 2, 48, 77, 169, 32, 177, 42, 111, 39, 168, 84, 139, 127, 52, 185, 155, 171, 115, 234, 170, 116, 59, 207, 216, 55, 83, 58, 116, 187, 96, 14, 52, 75, 123, 150, 136, 46, 157, 183, 37, 107, 85, 1, 56, 87, 124, 59, 37, 33, 29, 2, 49, 0, 205, 188, 51, 120, 100, 108, 161, 56, 154, 52, 212, 76, 252, 104, 6, 89, 70, 178, 34, 250, 96, 99, 177, 51, 240, 242, 143, 166, 5, 211, 91, 222, 231, 8, 252, 53, 219, 251, 210, 172, 106, 144, 31, 36, 254, 195, 97, 164, 104, 99, 97, 98, 117, 110, 100, 108, 101, 132, 89, 2, 21, 48, 130, 2, 17, 48, 130, 1, 150, 160, 3, 2, 1, 2, 2, 17, 0, 249, 49, 117, 104, 27, 144, 175, 225, 29, 70, 204, 180, 228, 231, 248, 86, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 49, 57, 49, 48, 50, 56, 49, 51, 50, 56, 48, 53, 90, 23, 13, 52, 57, 49, 48, 50, 56, 49, 52, 50, 56, 48, 53, 90, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 252, 2, 84, 235, 166, 8, 193, 243, 104, 112, 226, 154, 218, 144, 190, 70, 56, 50, 146, 115, 110, 137, 75, 255, 246, 114, 217, 137, 68, 75, 80, 81, 229, 52, 164, 177, 246, 219, 227, 192, 188, 88, 26, 50, 183, 177, 118, 7, 14, 222, 18, 214, 154, 63, 234, 33, 27, 102, 231, 82, 207, 125, 209, 221, 9, 95, 111, 19, 112, 244, 23, 8, 67, 217, 220, 16, 1, 33, 228, 207, 99, 1, 40, 9, 102, 68, 135, 201, 121, 98, 132, 48, 77, 197, 63, 244, 163, 66, 48, 64, 48, 15, 6, 3, 85, 29, 19, 1, 1, 255, 4, 5, 48, 3, 1, 1, 255, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 144, 37, 181, 13, 217, 5, 71, 231, 150, 195, 150, 250, 114, 157, 207, 153, 169, 223, 75, 150, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 163, 127, 47, 145, 161, 201, 189, 94, 231, 184, 98, 124, 22, 152, 210, 85, 3, 142, 31, 3, 67, 249, 91, 99, 169, 98, 140, 61, 57, 128, 149, 69, 161, 30, 188, 191, 46, 59, 85, 216, 174, 238, 113, 180, 195, 214, 173, 243, 2, 49, 0, 162, 243, 155, 22, 5, 178, 112, 40, 165, 221, 75, 160, 105, 181, 1, 110, 101, 180, 251, 222, 143, 224, 6, 29, 106, 83, 25, 127, 156, 218, 245, 217, 67, 188, 97, 252, 43, 235, 3, 203, 111, 238, 141, 35, 2, 243, 223, 246, 89, 2, 197, 48, 130, 2, 193, 48, 130, 2, 72, 160, 3, 2, 1, 2, 2, 17, 0, 172, 236, 57, 104, 36, 94, 12, 212, 200, 202, 103, 62, 41, 58, 135, 90, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 51, 48, 56, 49, 51, 48, 53, 49, 50, 51, 51, 90, 23, 13, 50, 51, 48, 57, 48, 50, 48, 54, 49, 50, 51, 51, 90, 48, 103, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 57, 48, 55, 6, 3, 85, 4, 3, 12, 48, 55, 101, 52, 52, 97, 48, 100, 102, 99, 56, 54, 50, 98, 55, 97, 55, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 40, 81, 9, 55, 220, 182, 221, 121, 61, 122, 117, 97, 248, 200, 190, 66, 120, 85, 211, 79, 244, 175, 184, 81, 47, 146, 250, 255, 173, 211, 211, 205, 175, 254, 71, 11, 219, 222, 101, 6, 212, 147, 186, 122, 48, 136, 214, 165, 47, 27, 176, 73, 214, 170, 194, 198, 254, 163, 21, 180, 230, 248, 172, 149, 148, 244, 241, 117, 6, 159, 57, 227, 192, 4, 61, 158, 151, 104, 206, 99, 51, 149, 225, 253, 235, 169, 19, 118, 247, 208, 63, 236, 20, 244, 211, 195, 163, 129, 213, 48, 129, 210, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 2, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 144, 37, 181, 13, 217, 5, 71, 231, 150, 195, 150, 250, 114, 157, 207, 153, 169, 223, 75, 150, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 56, 234, 62, 26, 54, 120, 149, 178, 97, 106, 105, 104, 188, 18, 244, 154, 51, 3, 185, 160, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 108, 6, 3, 85, 29, 31, 4, 101, 48, 99, 48, 97, 160, 95, 160, 93, 134, 91, 104, 116, 116, 112, 58, 47, 47, 97, 119, 115, 45, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 45, 99, 114, 108, 46, 115, 51, 46, 97, 109, 97, 122, 111, 110, 97, 119, 115, 46, 99, 111, 109, 47, 99, 114, 108, 47, 97, 98, 52, 57, 54, 48, 99, 99, 45, 55, 100, 54, 51, 45, 52, 50, 98, 100, 45, 57, 101, 57, 102, 45, 53, 57, 51, 51, 56, 99, 98, 54, 55, 102, 56, 52, 46, 99, 114, 108, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 103, 0, 48, 100, 2, 48, 115, 253, 251, 58, 29, 171, 122, 76, 160, 59, 36, 85, 252, 19, 35, 101, 127, 170, 243, 222, 35, 206, 95, 14, 253, 238, 90, 120, 178, 11, 191, 136, 238, 6, 71, 7, 51, 101, 217, 141, 18, 145, 173, 164, 251, 45, 5, 17, 2, 48, 90, 48, 215, 179, 215, 18, 193, 60, 150, 246, 44, 57, 4, 24, 36, 46, 161, 39, 239, 231, 143, 140, 124, 212, 45, 148, 133, 162, 252, 82, 238, 210, 144, 101, 81, 107, 207, 18, 194, 223, 114, 255, 154, 53, 68, 165, 231, 183, 89, 3, 36, 48, 130, 3, 32, 48, 130, 2, 166, 160, 3, 2, 1, 2, 2, 16, 26, 140, 131, 126, 208, 13, 100, 160, 90, 82, 71, 51, 190, 183, 169, 39, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 103, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 57, 48, 55, 6, 3, 85, 4, 3, 12, 48, 55, 101, 52, 52, 97, 48, 100, 102, 99, 56, 54, 50, 98, 55, 97, 55, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 51, 48, 56, 49, 52, 48, 49, 49, 54, 51, 48, 90, 23, 13, 50, 51, 48, 56, 50, 48, 48, 49, 49, 54, 50, 57, 90, 48, 129, 140, 49, 63, 48, 61, 6, 3, 85, 4, 3, 12, 54, 56, 51, 49, 98, 48, 53, 54, 97, 48, 102, 51, 52, 54, 48, 99, 54, 46, 122, 111, 110, 97, 108, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 11, 48, 9, 6, 3, 85, 4, 8, 12, 2, 87, 65, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 67, 208, 163, 180, 68, 122, 95, 255, 168, 210, 135, 96, 103, 142, 111, 194, 246, 134, 28, 98, 65, 206, 142, 240, 204, 1, 101, 65, 44, 38, 71, 70, 13, 202, 136, 115, 71, 219, 4, 229, 22, 198, 124, 43, 109, 192, 90, 158, 50, 170, 1, 135, 232, 111, 2, 151, 26, 239, 222, 119, 28, 173, 203, 231, 253, 20, 216, 113, 114, 151, 125, 120, 221, 15, 59, 54, 139, 179, 150, 147, 169, 167, 157, 211, 223, 174, 96, 250, 100, 160, 42, 253, 157, 82, 180, 241, 163, 129, 240, 48, 129, 237, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 1, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 56, 234, 62, 26, 54, 120, 149, 178, 97, 106, 105, 104, 188, 18, 244, 154, 51, 3, 185, 160, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 211, 143, 49, 155, 204, 40, 62, 112, 94, 214, 221, 144, 62, 22, 8, 177, 88, 78, 27, 249, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 129, 134, 6, 3, 85, 29, 31, 4, 127, 48, 125, 48, 123, 160, 121, 160, 119, 134, 117, 104, 116, 116, 112, 58, 47, 47, 99, 114, 108, 45, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 45, 97, 119, 115, 45, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 46, 115, 51, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 109, 97, 122, 111, 110, 97, 119, 115, 46, 99, 111, 109, 47, 99, 114, 108, 47, 53, 49, 97, 102, 98, 55, 49, 97, 45, 100, 99, 99, 99, 45, 52, 50, 48, 56, 45, 98, 50, 55, 101, 45, 101, 48, 56, 50, 57, 50, 52, 49, 57, 49, 55, 98, 46, 99, 114, 108, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 104, 0, 48, 101, 2, 48, 9, 54, 254, 110, 31, 166, 25, 14, 61, 231, 183, 51, 32, 253, 36, 190, 179, 78, 63, 42, 153, 177, 180, 110, 32, 106, 97, 130, 170, 153, 5, 2, 13, 108, 210, 118, 81, 1, 203, 14, 14, 209, 180, 171, 155, 125, 240, 87, 2, 49, 0, 161, 112, 174, 177, 15, 53, 206, 36, 92, 69, 192, 217, 205, 125, 192, 153, 133, 44, 162, 1, 78, 132, 255, 41, 44, 20, 206, 247, 81, 195, 166, 59, 138, 45, 82, 222, 249, 110, 126, 56, 94, 93, 41, 157, 231, 177, 70, 79, 89, 2, 136, 48, 130, 2, 132, 48, 130, 2, 10, 160, 3, 2, 1, 2, 2, 20, 57, 145, 74, 43, 55, 216, 179, 240, 46, 145, 37, 215, 243, 169, 196, 228, 157, 212, 199, 101, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 129, 140, 49, 63, 48, 61, 6, 3, 85, 4, 3, 12, 54, 56, 51, 49, 98, 48, 53, 54, 97, 48, 102, 51, 52, 54, 48, 99, 54, 46, 122, 111, 110, 97, 108, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 11, 48, 9, 6, 3, 85, 4, 8, 12, 2, 87, 65, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 48, 30, 23, 13, 50, 51, 48, 56, 49, 52, 49, 48, 50, 48, 49, 57, 90, 23, 13, 50, 51, 48, 56, 49, 53, 49, 48, 50, 48, 49, 57, 90, 48, 129, 145, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 60, 48, 58, 6, 3, 85, 4, 3, 12, 51, 105, 45, 48, 48, 49, 50, 54, 55, 98, 49, 97, 49, 53, 50, 48, 57, 100, 53, 102, 46, 101, 117, 45, 99, 101, 110, 116, 114, 97, 108, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 38, 122, 151, 177, 39, 210, 128, 222, 214, 3, 38, 242, 68, 66, 53, 85, 25, 166, 171, 196, 180, 127, 62, 21, 227, 106, 30, 142, 170, 145, 242, 125, 232, 14, 70, 199, 153, 241, 240, 27, 61, 86, 179, 40, 112, 11, 235, 184, 20, 25, 241, 253, 18, 148, 6, 20, 69, 51, 27, 146, 203, 242, 96, 145, 120, 172, 36, 45, 217, 114, 196, 189, 19, 43, 172, 190, 158, 218, 248, 180, 86, 8, 4, 231, 28, 207, 91, 28, 138, 144, 185, 186, 99, 37, 232, 157, 163, 38, 48, 36, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 0, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 2, 4, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 104, 0, 48, 101, 2, 48, 59, 19, 161, 107, 93, 61, 200, 23, 185, 93, 186, 48, 194, 223, 31, 124, 9, 35, 155, 104, 110, 61, 145, 44, 204, 33, 92, 122, 67, 151, 41, 66, 55, 7, 2, 67, 29, 122, 112, 49, 101, 196, 224, 0, 194, 234, 62, 158, 2, 49, 0, 183, 107, 92, 226, 106, 162, 91, 80, 86, 167, 16, 158, 241, 96, 85, 93, 224, 195, 208, 61, 21, 231, 208, 221, 5, 111, 67, 174, 172, 252, 39, 148, 5, 228, 186, 196, 42, 238, 147, 223, 124, 172, 117, 181, 248, 45, 11, 12, 106, 112, 117, 98, 108, 105, 99, 95, 107, 101, 121, 89, 1, 195, 45, 45, 45, 45, 45, 66, 69, 71, 73, 78, 32, 80, 85, 66, 76, 73, 67, 32, 75, 69, 89, 45, 45, 45, 45, 45, 10, 77, 73, 73, 66, 73, 106, 65, 78, 66, 103, 107, 113, 104, 107, 105, 71, 57, 119, 48, 66, 65, 81, 69, 70, 65, 65, 79, 67, 65, 81, 56, 65, 77, 73, 73, 66, 67, 103, 75, 67, 65, 81, 69, 65, 114, 56, 102, 109, 57, 86, 85, 65, 70, 103, 113, 80, 72, 72, 50, 85, 56, 116, 109, 97, 10, 116, 117, 53, 122, 54, 56, 106, 79, 88, 102, 109, 89, 104, 54, 86, 80, 47, 115, 102, 99, 80, 104, 69, 118, 87, 90, 105, 53, 53, 84, 52, 106, 54, 47, 113, 53, 86, 47, 113, 77, 88, 56, 57, 110, 99, 56, 86, 106, 85, 84, 122, 86, 82, 112, 111, 115, 47, 75, 101, 107, 53, 108, 109, 88, 10, 68, 101, 121, 100, 120, 66, 89, 84, 43, 101, 115, 50, 108, 49, 55, 72, 120, 97, 108, 112, 118, 83, 53, 83, 53, 49, 70, 112, 52, 66, 112, 101, 108, 111, 83, 115, 82, 84, 121, 65, 80, 74, 78, 88, 114, 86, 112, 104, 66, 86, 119, 103, 90, 85, 114, 117, 52, 111, 108, 82, 72, 110, 99, 75, 10, 65, 106, 48, 104, 77, 51, 70, 77, 113, 67, 90, 78, 87, 84, 119, 73, 117, 104, 102, 50, 116, 68, 80, 99, 84, 66, 104, 103, 108, 107, 102, 50, 73, 72, 73, 105, 76, 86, 113, 73, 122, 115, 122, 119, 121, 84, 81, 54, 99, 69, 118, 107, 107, 43, 89, 74, 69, 121, 98, 105, 84, 97, 102, 76, 10, 112, 47, 98, 75, 117, 110, 121, 102, 84, 79, 112, 97, 114, 82, 117, 118, 114, 57, 53, 66, 107, 101, 107, 90, 88, 86, 104, 107, 86, 55, 83, 108, 67, 48, 84, 70, 112, 115, 111, 53, 110, 101, 84, 81, 98, 103, 77, 43, 106, 84, 104, 71, 68, 53, 97, 114, 66, 51, 116, 52, 65, 82, 55, 104, 10, 97, 104, 84, 71, 113, 97, 122, 79, 52, 98, 104, 68, 75, 110, 71, 57, 120, 84, 80, 85, 55, 67, 103, 116, 111, 84, 108, 76, 79, 98, 88, 73, 119, 102, 49, 85, 110, 119, 111, 103, 47, 84, 85, 73, 86, 57, 111, 82, 121, 104, 68, 75, 108, 118, 107, 89, 85, 85, 67, 48, 77, 82, 108, 57, 10, 117, 119, 73, 68, 65, 81, 65, 66, 10, 45, 45, 45, 45, 45, 69, 78, 68, 32, 80, 85, 66, 76, 73, 67, 32, 75, 69, 89, 45, 45, 45, 45, 45, 10, 105, 117, 115, 101, 114, 95, 100, 97, 116, 97, 77, 104, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100, 33, 101, 110, 111, 110, 99, 101, 77, 78, 111, 110, 99, 101, 32, 105, 115, 32, 104, 101, 114, 101, 88, 96, 7, 90, 118, 250, 205, 11, 217, 2, 54, 204, 141, 223, 111, 224, 189, 6, 239, 97, 187, 3, 132, 240, 32, 174, 226, 107, 226, 248, 142, 21, 244, 21, 205, 116, 31, 65, 132, 231, 146, 210, 215, 235, 169, 50, 168, 239, 161, 32, 228, 255, 243, 119, 118, 93, 66, 201, 204, 130, 94, 68, 212, 238, 28, 34, 78, 107, 93, 93, 252, 248, 133, 12, 64, 61, 133, 23, 28, 112, 11, 23, 34, 243, 128, 254, 157, 54, 35, 130, 110, 34, 217, 94, 189, 128, 231, 7]};
    let u8_slice: &[u8] = &byte_array;

    let _document = match AttestationDocument::authenticate(u8_slice, cert){
        Ok(_doc) => {
            println!("Correct");
        },
        Err(err) => {
            println!("Error: {}", err);
        }
    };

    // if let Ok(Response::Attestation { ref document }) = attestation_response {
    //     let document_attested = match AttestationDocument::authenticate(document.as_slice(), cert) {
    //         Ok(doc) => doc,
    //         Err(err) => {
    //             println!("{:?}", err);
    //             panic!("error invalid attestation document");
    //         }
    //     };
    //     println!("Correct!");
    //     let mut document_attested_decoded = AttestationDocumentDecoded {
    //         pcrs: HashMap::new(),
    //         nonce: String::new(),
    //         module_id: String::new(),
    //         public_key: String::new(),
    //     };
    //     // println!("-----");
    //     for (index, pcr) in document_attested.pcrs.iter().enumerate() {
    //         let hex_vector = decimal_to_hex(&pcr);
    //         let result = remove_brackets_commas_and_spaces(&hex_vector);
    //         // println!("PCR{} value is: {:?}",index, result);
    //         // println!("-----");
    //         let pcr_index = format!("PCR{}", index);
    //         document_attested_decoded.pcrs.insert(pcr_index, result);
    //     }
    //     // println!("Module Id: {:?}",document_attested.module_id);
    //
    //     document_attested_decoded.nonce = convert_decimals_to_ascii(document_attested.nonce);
    //     document_attested_decoded.module_id = document_attested.module_id;
    //     document_attested_decoded.public_key =
    //         option_vec_u8_to_string(document_attested.public_key);
    //
    //     // println!("{}",document_attested_decoded);
    //
    //     let json = serde_json::to_string(&document_attested_decoded).unwrap();
    //     println!("{}", json);
    // }
    // else if let Err(err) = attestation_response {
    //     println!("Error parsing response: {:?}", err);
    //     println!("Failed");
    // }






}
